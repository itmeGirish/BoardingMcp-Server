Connecting to database with URL: postgresql+psycopg://mystartup:NewStrongPass456@127.0.0.1:5432/Agent_steer
============================= test session starts =============================
platform win32 -- Python 3.13.7, pytest-9.0.2, pluggy-1.6.0 -- C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\agent_steer\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.1, inline-snapshot-0.31.1, langsmith-0.6.4, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending 
============================================================
  REAL BROADCAST TEST
  Job ID: real-broadcast-9dc44d24-eeb4-48ea-a3c5-d86d1f64d876
  Contacts: Girish, Vamsi, Santhu, Mahesh
============================================================

  [INITIALIZED] Broadcast job created
  [DATA_PROCESSING] 4 contacts processed: ['+918861832522', '+919177604610', '+919353578022', '+918297347120']
  [COMPLIANCE_CHECK] Passed (health data stored)
  [SEGMENTATION] 1 segment: All Contacts (4)
  [CONTENT_CREATION] Submitting new template: bedzee_broadcast_2fe78fd9
  [CONTENT_CREATION] Template submitted - ID: 26160624353626527, status: PENDING

  [WAITING] Polling template approval status (every 10s, up to 5 min)...
    Poll 1/30: status = REJECTED
  [CONTENT_CREATION] Template final status: REJECTED
  [CONTENT_CREATION] Template status: REJECTED - looking for APPROVED fallback...
  [CONTENT_CREATION] Fallback to APPROVED template: bedzee_broadcast_f3bd2c7d (ID: 2220243888384933)
  [READY_TO_SEND] Using fallback template

  [SENDING] Broadcasting to 4 contacts via MCP (port 9002)...
  Template: bedzee_broadcast_f3bd2c7d (MARKETING, en_US)
  --------------------------------------------------
  [1/4] Girish (+918861832522) -> FAILED: Bad request
  [2/4] Vamsi (+919177604610) -> FAILED: Bad request
  [3/4] Santhu (+919353578022) -> FAILED: Bad request
  [4/4] Mahesh (+918297347120) -> FAILED: Bad request

  --------------------------------------------------
  DELIVERY RESULT: 0 sent, 4 failed out of 4
  [COMPLETED] Broadcast finished

  Final DB state:
    Phase: COMPLETED
    Sent: 0
    Failed: 4
    Template: bedzee_broadcast_f3bd2c7d
    Started: 2026-02-09T17:13:43.940072
    Completed: 2026-02-09T17:13:47.760913
============================================================
PASSED

============================== warnings summary ===============================
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:50: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:51: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    updated_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:121: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:150: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\processed_contact_repo.py:53: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:194: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:211: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Python313\Lib\contextlib.py:109: DeprecationWarning: Use `streamable_http_client` instead.
    self.gen = func(*args, **kwds)

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\template_creation_repo.py:66: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    submitted_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\template_creation_repo.py:67: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\template_creation_repo.py:68: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    updated_at=datetime.utcnow(),

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\template_creation_repo.py:178: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:124: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.started_sending_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:230: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.updated_at = datetime.utcnow()

tests/integration/test_broadcasting.py::TestRealMCPBroadcast::test_step5_full_broadcast_with_mcp_sending
  C:\Girish\Fundamental_Projects\ActionAi\Agent_steer_backend\BoardingMcp-Server\app\database\postgresql\postgresql_repositories\broadcast_job_repo.py:126: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    record.completed_at = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 1 passed, 32 warnings in 19.70s =======================
